<div class="userList">
    <div class="mb-4">
      <app-navbar></app-navbar>
    </div>

    <div class="container shadow p-3 mb-5 bg-body-tertiary  rounded p-2 mb-5">
      <div class="d-flex justify-content-between mb-4">
        <select
          name="demo"
          #roleSort
          (change)="roleSortby(roleSort.value)"
        >
          <option selected="selected" value="">All</option>
          <option value="user">User</option>
          <option value="admin">Admin</option>
        </select>
        <select
          class="rounded"
          name="demo"
          #sortBy
          (change)="sortByData(sortBy.value)"
        >
          <option selected="selected" value="name">Name</option>
          <option value="email">Email</option>
        </select>
        <select
          class="rounded px-2"
          name="demo"
          #limit
          (change)="handleLimit(limit.value)"
        >
          <option selected="selected" value="5">5</option>
          <option value="10">10</option>
          <option value="15">15</option>
        </select>
        <form class="d-flex" role="search ">
          <input
            #serchData
            class="form-control me-2"
            type="search"
            placeholder="Search"
            aria-label="Search"
          />
          <button
            (click)="serchValue(serchData.value)"
            class="btn btn-outline-success"
            type="submit"
          >
            Search
          </button>
        </form>
      </div>
      <div class="d-flex justify-content-end">
        <button
          type="button"
          class="btn btn-primary"
          data-bs-toggle="modal"
          data-bs-target="#staticBackdrop"
          (click)="togglemodalforEditUser(true)"
        >
          <i class="bi bi-person-plus-fill">&nbsp;</i>addUser
        </button>
      </div>
      <table class="table text-center mt-2">
        <thead class="bg-success">
          <tr>
            <th scope="col ">#</th>
            <th scope="col">Name</th>
            <th scope="col ">Role</th>
            <th scope="col">Email</th>
            <th scope="col ">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of userList; index as i">
            <th scope="row">{{ i + 1 }}</th>
            <td>{{ user?.name }}</td>
             <td>
              <div class="d-flex justify-content-between">
                <span>{{ user?.role }}</span>
                <button
                  class="btn btn-sm btn-outline-info"
                  data-bs-toggle="modal"
                  data-bs-target="#roleCHangeEdit"
                  (click)="getEditId(user._id)"
                >
                  <i class="bi bi-pencil"></i>
                </button>
              </div>
            </td>
            <td>{{ user?.email }}</td>
            <td>
              <button
                type="button"
                class="btn btn-outline-info mx-2"
                data-bs-toggle="modal"
                data-bs-target="#staticBackdrop"
                (click)="togglemodalforEditUser(false, user)"
              >
                <i class="bi bi-pencil-square"></i>
              </button>
              <button
                class="btn btn-outline-danger"
                (click)="deleteUser(user._id)"
              >
                <i class="bi bi-trash-fill"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
      <nav
        aria-label="Page navigation example"
        class="d-flex justify-content-center"
      >
        <ul class="pagination">
          <li class="page-item">
            <button
              class="btn btn-primary"
              [disabled]="page === 1"
              (click)="previousPage()"
            >
              Previous
            </button>
          </li>
          <li class="page-item">
            <a class="page-link">{{ page }}</a>
          </li>
          <li class="page-item">
            <button
              class="btn btn-primary"
              [disabled]="page === totalpages"
              (click)="nextPage()"
            >
              Next
            </button>
          </li>
        </ul>
      </nav>
    </div>
  </div>
  <!-- Modal -->
  <div
    class="modal fade"
    id="staticBackdrop"
    data-bs-backdrop="static"
    data-bs-keyboard="false"
    tabindex="-1"
    aria-labelledby="staticBackdropLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 *ngIf="editData" class="modal-title fs-5" id="staticBackdropLabel">
            <i class="bi bi-person-fill-add"></i>&nbsp;ADD NEW USER
          </h1>
          <h1 *ngIf="!editData" class="modal-title fs-5" id="staticBackdropLabel">
            <i class="bi bi-person-fill-add"></i>&nbsp;EDIT USERDETAILS
          </h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <form
            (ngSubmit)="editData ? collection() : editUserData()"
            [formGroup]="register"
          >
            <div class="mb-3">
              <label for="exampleInputEmail1" class="form-label mx-2"
                >Full Name<span style="color: red">*</span></label
              >
              <div>
                <i class="fa fa-user position-absolute mt-2 ms-3"></i>
                <input
                  type="text"
                  class="form-control border-0 border-bottom px-5"
                  formControlName="name"
                  placeholder="Enter Full Name"
                />
              </div>
              <span
                class="text-danger"
                *ngIf="name?.touched && register.get('name')?.errors?.['isVoidSpace']"
              >
                <strong>Not allowed</strong> blank spaces* &nbsp;
              </span>
              <span
                style="color: red"
                *ngIf="name && name.touched && register.get('name')?.errors?.['required']"
                >This fild is invalid</span
              >
            </div>
            <div class="mb-3" *ngIf="editData">
              <label for="exampleInputEmail1" class="form-label mx-2"
                >Role<span style="color: red">*</span></label
              >
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  formControlName="role"
                  type="radio"
                  name="inlineRadioOptions"
                  id="inlineRadio1"
                  value="user"
                />
                <label class="form-check-label" for="inlineRadio1">User</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  formControlName="role"
                  type="radio"
                  name="inlineRadioOptions"
                  id="inlineRadio2"
                  value="admin"
                />
                <label class="form-check-label" for="inlineRadio2">Admin</label>
              </div>
            </div>

            <div class="mb-3">
              <label for="exampleInputEmail1" class="form-label mx-2"
                >Email address<span style="color: red">*</span></label
              >
              <div>
                <i class="fa fa-envelope position-absolute mt-2 ms-3"></i>
                <input
                  type="email"
                  class="form-control border-0 border-bottom px-5"
                  formControlName="email"
                  placeholder="Enter Email address"
                />
              </div>
              <span
                style="color: red"
                *ngIf="email && email.invalid && email.touched"
                >This fild is invalid</span
              >
            </div>

            <div class="mb-3">
              <label for="exampleInputPassword1" class="form-label mx-2"
                >Password<span style="color: red">*</span></label
              >
              <div>
                <i class="fa fa-key position-absolute mt-2 ms-3"></i>
                <input
                  type="password"
                  class="form-control border-0 border-bottom px-5"
                  formControlName="password"
                  placeholder="Enter Password"
                />
              </div>
              <span
                class="text-danger"
                *ngIf="Password?.touched && register.get('password')?.errors?.['isVoidSpace']"
              >
                <strong>Not allowed</strong> blank spaces* &nbsp;
              </span>
              <span
                *ngIf="Password && register.get('password')?.errors?.['required'] && Password.touched"
                style="color: red"
                >This field is invalid</span
              >
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button
                [disabled]="register.invalid"
                type="submit"
                class="btn btn-success"
                data-bs-dismiss="modal"
                aria-label="Close"
              >
                Save
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div
    class="modal fade"
    id="roleCHangeEdit"
    data-bs-backdrop="static"
    data-bs-keyboard="false"
    tabindex="-1"
    aria-labelledby="staticBackdropLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Edit Role</h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <label for="exampleInputEmail1" class="form-label mx-2"
            >Role<span style="color: red">*</span></label
          >
          <div class="form-check form-check-inline">
            <input
              [(ngModel)]="role"
              class="form-check-input"
              type="radio"
              name="inlineRadioOptions"
              id="inlineRadio11"
              value="user"
            />
            <label class="form-check-label" for="inlineRadio1">User</label>
          </div>
          <div class="form-check form-check-inline">
            <input
              [(ngModel)]="role"
              class="form-check-input"
              type="radio"
              name="inlineRadioOptions"
              id="inlineRadio21"
              value="admin"
            />
            <label class="form-check-label" for="inlineRadio2">Admin</label>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="submit"
              class="btn btn-success"
              data-bs-dismiss="modal"
              aria-label="Close"
              (click)="editRole()"
            >
              Save
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

